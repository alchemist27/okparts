<!--
  ========================================
  íŒë§¤ì ì•± ìë™ ì—°ë™ ì½”ë“œ (ë°©ë²• 1: localStorage)
  ========================================

  ğŸ“‹ ì‚¬ìš© ë°©ë²•:
  1. ì¹´í˜24 ê´€ë¦¬ì > ë””ìì¸ í¸ì§‘ > HTML í¸ì§‘
  2. member_result.html ë˜ëŠ” join_result.html íŒŒì¼ ì—´ê¸°
  3. íŒŒì¼ ë§¨ ë (ë§ˆì§€ë§‰ </div> ë˜ëŠ” </body> ì „)ì— ì•„ë˜ ì½”ë“œ ì „ì²´ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°
  4. ì €ì¥ í›„ ìºì‹œ ì´ˆê¸°í™”

  âœ… ë„ë©”ì¸: okparts.vercel.app
  âœ… ë°©ì‹: localStorageì—ì„œ ë°ì´í„° ì½ê¸° (ê¶Œí•œ ë¶ˆí•„ìš”)
-->

<!-- íŒë§¤ì ì•± ìë™ ì—°ë™ ë²„íŠ¼ (localStorage ë°©ì‹) -->
<script>
(function() {
  console.log('ğŸš€ íŒë§¤ì ì•± ì—°ë™ ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ (localStorage ë°©ì‹)');

  // localStorageì—ì„œ ê°€ì… ì •ë³´ ê°€ì ¸ì˜¤ê¸°
  var signupData = localStorage.getItem('pendingSellerSignup');

  if (!signupData) {
    console.log('âš ï¸ localStorageì— íŒë§¤ì ê°€ì… ì •ë³´ ì—†ìŒ');
    console.log('   ì¼ë°˜ ê³ ê°ì´ê±°ë‚˜ join.html ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
    return;
  }

  var memberInfo;
  try {
    memberInfo = JSON.parse(signupData);
    console.log('âœ… localStorageì—ì„œ ê°€ì… ì •ë³´ ë¡œë“œ:', memberInfo);
  } catch (e) {
    console.error('âŒ localStorage ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);
    return;
  }

  // ì‚¬ì—…ìë²ˆí˜¸ í™•ì¸
  if (!memberInfo.businessNumber || memberInfo.businessNumber.trim() === '') {
    console.log('âš ï¸ ì‚¬ì—…ìë²ˆí˜¸ ì—†ìŒ - ì¼ë°˜ ê³ ê°');
    localStorage.removeItem('pendingSellerSignup'); // ì •ë¦¬
    return;
  }

  console.log('âœ… ì‚¬ì—…ì íšŒì› í™•ì¸:', memberInfo.businessNumber);

  // ë²„íŠ¼ì„ ì¶”ê°€í•  ìœ„ì¹˜ ì°¾ê¸°
  var targetElement = document.querySelector('.ec-base-button.gBottom');

  if (!targetElement) {
    console.log('âš ï¸ .gBottomì„ ì°¾ì„ ìˆ˜ ì—†ìŒ, ëŒ€ì²´ ìœ„ì¹˜ ì‹œë„');
    targetElement = document.querySelector('.joinComplete');
  }

  if (!targetElement) {
    console.log('âš ï¸ .joinCompleteì„ ì°¾ì„ ìˆ˜ ì—†ìŒ, ëŒ€ì²´ ìœ„ì¹˜ ì‹œë„');
    targetElement = document.querySelector('.memberArea');
  }

  if (!targetElement) {
    console.error('âŒ ë²„íŠ¼ ì‚½ì… ìœ„ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
    return;
  }

  console.log('âœ… ë²„íŠ¼ ì‚½ì… ìœ„ì¹˜ í™•ì¸:', targetElement.className);

  // íŒë§¤ì ì•± ì„¹ì…˜ ìƒì„±
  var sellerSection = document.createElement('div');
  sellerSection.id = 'seller-app-section';
  sellerSection.style.cssText = 'margin-top: 30px; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);';

  // ëª¨ë°”ì¼ ëŒ€ì‘
  if (window.innerWidth <= 768) {
    sellerSection.style.padding = '20px';
  }

  // ì œëª©
  var title = document.createElement('h3');
  title.style.cssText = 'color: white; font-size: 22px; margin-bottom: 10px; font-weight: bold; margin-top: 0;';
  if (window.innerWidth <= 768) {
    title.style.fontSize = '18px';
  }
  title.textContent = 'ğŸ‰ ì‚¬ì—…ì íšŒì› ê°€ì… ì™„ë£Œ!';

  // ì„¤ëª…
  var description = document.createElement('p');
  description.style.cssText = 'color: rgba(255,255,255,0.95); font-size: 16px; margin-bottom: 20px; line-height: 1.6; margin-top: 0;';
  if (window.innerWidth <= 768) {
    description.style.fontSize = '14px';
  }
  description.innerHTML = '<strong>' + memberInfo.name + '</strong> ë‹˜ì€ íŒë§¤ì ì•±ì—ì„œ<br/>ë°”ë¡œ ìƒí’ˆì„ ë“±ë¡í•˜ê³  íŒë§¤ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';

  // ë²„íŠ¼ ìƒì„±
  var loginBtn = document.createElement('a');

  // âœ… okparts.vercel.app ë„ë©”ì¸ + localStorage ë°ì´í„° ì‚¬ìš©
  var targetUrl = 'https://okparts.vercel.app/api/signup-redirect?' +
                  'member_id=' + encodeURIComponent(memberInfo.member_id) +
                  '&email=' + encodeURIComponent(memberInfo.email) +
                  '&extra_1=' + encodeURIComponent(memberInfo.businessNumber) +
                  '&extra_2=' + encodeURIComponent(memberInfo.president) +
                  '&extra_3=' + encodeURIComponent(memberInfo.phone);

  console.log('ğŸ”— ë¦¬ë””ë ‰ì…˜ URL:', targetUrl);

  loginBtn.href = targetUrl;
  loginBtn.style.cssText = 'display: inline-block; padding: 16px 50px; background: white; color: #667eea; ' +
                          'text-decoration: none; border-radius: 30px; font-size: 18px; font-weight: bold; ' +
                          'box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: all 0.3s; margin-top: 10px;';
  if (window.innerWidth <= 768) {
    loginBtn.style.fontSize = '16px';
    loginBtn.style.padding = '14px 30px';
  }
  loginBtn.textContent = 'íŒë§¤ì ì•± ë¡œê·¸ì¸í•˜ê¸° â†’';

  // í˜¸ë²„ íš¨ê³¼
  loginBtn.onmouseover = function() {
    this.style.transform = 'translateY(-2px)';
    this.style.boxShadow = '0 6px 20px rgba(0,0,0,0.3)';
  };
  loginBtn.onmouseout = function() {
    this.style.transform = 'translateY(0)';
    this.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
  };

  // ë²„íŠ¼ í´ë¦­ ì‹œ localStorage ì •ë¦¬
  loginBtn.onclick = function() {
    console.log('ğŸ§¹ localStorage ì •ë¦¬');
    localStorage.removeItem('pendingSellerSignup');
  };

  // ì•ˆë‚´ ë¬¸êµ¬
  var note = document.createElement('p');
  note.style.cssText = 'color: rgba(255,255,255,0.8); font-size: 13px; margin-top: 15px; margin-bottom: 0;';
  if (window.innerWidth <= 768) {
    note.style.fontSize = '12px';
  }
  note.textContent = 'íŒë§¤ì ì•±ì—ì„œ ìƒí’ˆì„ ë°”ë¡œ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤';

  // ì¡°ë¦½
  sellerSection.appendChild(title);
  sellerSection.appendChild(description);
  sellerSection.appendChild(loginBtn);
  sellerSection.appendChild(note);

  // DOMì— ì‚½ì…
  if (targetElement.parentNode) {
    targetElement.parentNode.insertBefore(sellerSection, targetElement.nextSibling);
  } else {
    document.body.appendChild(sellerSection);
  }

  console.log('âœ… íŒë§¤ì ì•± ë²„íŠ¼ ì¶”ê°€ ì™„ë£Œ');

  // 5ë¶„ í›„ ìë™ìœ¼ë¡œ localStorage ì •ë¦¬ (ì•ˆì „ì¥ì¹˜)
  setTimeout(function() {
    if (localStorage.getItem('pendingSellerSignup')) {
      console.log('ğŸ§¹ 5ë¶„ ê²½ê³¼ - localStorage ìë™ ì •ë¦¬');
      localStorage.removeItem('pendingSellerSignup');
    }
  }, 5 * 60 * 1000);
})();
</script>

<!--
  ========================================
  ì„¤ì¹˜ ì™„ë£Œ!
  ========================================

  âœ… ë‹¤ìŒ ë‹¨ê³„:
  1. ì €ì¥ ë²„íŠ¼ í´ë¦­
  2. ìºì‹œ ì´ˆê¸°í™” (ì¹´í˜24 ê´€ë¦¬ì > ë””ìì¸ í¸ì§‘ > ìºì‹œ ì´ˆê¸°í™”)
  3. join.htmlì—ë„ ì½”ë“œ ì¶”ê°€ ì™„ë£Œí–ˆëŠ”ì§€ í™•ì¸
  4. í…ŒìŠ¤íŠ¸ íšŒì›ê°€ì…

  ğŸ” ë””ë²„ê¹…:
  - Console ë¡œê·¸ í™•ì¸: F12 > Console íƒ­
  - localStorage í™•ì¸: F12 > Application > Local Storage
  - ë²„íŠ¼ì´ ì•ˆ ë³´ì´ë©´: ìºì‹œ ì‚­ì œ í›„ ìƒˆë¡œê³ ì¹¨ (Ctrl+Shift+R)

  ğŸ’¡ ì‘ë™ ì›ë¦¬:
  - join.htmlì—ì„œ íšŒì›ê°€ì… ì‹œ localStorageì— ì €ì¥
  - member_result.htmlì—ì„œ localStorage ì½ì–´ì„œ URL ìƒì„±
  - ê¶Œí•œ ë¶ˆí•„ìš” (mall.read_customer ì—†ì–´ë„ ë¨)
-->
